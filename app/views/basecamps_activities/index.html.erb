<div class="container">
  <h3>Choisis ton camp de base</h3>
  <div class="basecamps-activities-container" data-ors-api-key="<%= ENV['ORS_API_KEY'] %>">
    <div class="row">
      <div class="col s12">
        <ul class="tabs tabs-fixed-width">
          <li class="tab col s1"><a class="active" href="#list">Liste</a></li>
          <li class="tab col s1"><a class="" href="#map-ba">Carte</a></li>
        </ul>
          <div id="list">
            <div class="slide-container">
              <br>
            <% counter = 0 %>
            <% @basecamps_activities.each do |base| %>
              <% counter += 1 %>
              <div class="col s12 m5">

                <div class="card card-basecamp-activity horizontal small">
                  <div class="card-image">
                    <% if base.activity.name == "ski de randonnée" %>
                       <%= cl_image_tag("crux/images/ski.png.png") %>
                    <% elsif base.activity.name == "alpinisme" %>
                       <%= cl_image_tag("crux/images/alpi.png.png")%>
                    <% elsif base.activity.name == "escalade" %>
                       <%= cl_image_tag("crux/images/escalade.png.png") %>
                    <% end %>
                  </div>
                  <div class="card-stacked">
                    <div class="card-content" data-coords="<%= { ori_lat: @trip.coord_lat, ori_long: @trip.coord_long, desti_lat: base.basecamp.coord_lat, desti_long: base.basecamp.coord_long }.to_json %>">

                        <% b_a_name = base.basecamp.name.encode("iso-8859-1").force_encoding("utf-8") %>

                        <% if counter < 7 %>
                          <p class="ellipsis strong">
                          <%= b_a_name %><span>  <i class="fas fa-heart"></i></span>
                          </p>
                        <% else %>
                          <p>
                          <strong><%= b_a_name %></strong>
                          </p>
                        <% end %>



                      <br>
                      <p id="itinerary-number"><strong><%= base.nb_itineraries %></strong> itinéraires en <strong><%= base.activity.name.split(" ")[0] %></strong></p>
                      <br>
                      <% if base.basecamp.mountain_range.max_risk > 2 %>
                        <p><i class="fas fa-exclamation-triangle"></i> Risque d'avalanche (<%= base.basecamp.mountain_range.max_risk %>)</p>
                      <% else %>
                      <p><i class="fas fa-thumbs-up"></i> Risque faible</p>
                      <% end %>
                      <br>
                      <p><img src="<%= "http:" + base.basecamp.weather.forecast[0]["day"]["condition"]["icon"].to_s %>" style="width: 32px; height: 32px;"> <%= base.basecamp.weather.forecast[0]["day"]["avgtemp_c"].to_s.gsub(".", ",") %>°C</p>
                    </div>
                    <div class="card-action">
                      <div class="left-align">
                        <%= link_to "Explorer", trip_basecamps_activity_path(@trip, base), class: "waves-effect waves-light btn" %>
                        <button class="waves-effect waves-light btn secondary"><i class="fas fa-envelope"></i></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
            </div>
          </div>
          <div id="map-ba">
            <div class="slide-container" id="content-map">
              <%= render partial: "mapbox" %>
            </div>
          </div>


      </div>
    </div>
  </div>





</div>

